
version: 2.1
jobs:
  build:
    docker:
      - image: cimg/base:current
    resource_class: ewsaxyfkcp5g9tbybh5unx/k8stest
    steps:
      - run: echo "Hi I'm on a Container Runner!"


executors:
  terraform-executor:
    docker:
      - image: hashicorp/terraform:latest


  infrastructure_tests:
    docker:
      - image: golang:latest
    steps:
      - checkout
      - run:
          name: Run Infrastructure Tests
          command: go test ./terratest/test/main.go

workflows:
  version: 2
  build-workflow:
    jobs:
      - build
  test_and_deploy:
    jobs:
      - tfsec
      - infrastructure_tests



